plugins {
    id 'java'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
    }
}

compileJava {
    options.encoding = 'UTF-8'
    sourceCompatibility = '11'
    targetCompatibility = '11'
}

jar {
    manifest {
        attributes 'Main-Class': 'net.jbock.cp.CopyFile'
    }
}

repositories {
    mavenCentral()
    maven { url 'https://oss.sonatype.org/content/repositories/comgithubh908714124-1426' }
}

dependencies {
    compileOnly 'com.github.h908714124:jbock-annotations:4.4'
    annotationProcessor 'com.github.h908714124:jbock:4.4.000'
}

task jarWithDeps(dependsOn: 'jar', type: Copy) {
    def conf = configurations.compileClasspath
    from conf.allDependencies.collect { conf.files(it) }
    into "${project.buildDir}/libs"
}

tasks.build.dependsOn(jarWithDeps)
