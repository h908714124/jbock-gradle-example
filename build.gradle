plugins {
    id 'java'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(16)
    }
}

compileJava {
    options.encoding = 'UTF-8'
    sourceCompatibility = '16'
    targetCompatibility = '16'
}

jar {
    manifest {
        attributes 'Main-Class': 'net.jbock.cp.CopyFile'
    }
}

repositories {
    mavenCentral()
}

dependencies {
    compileOnly 'com.github.h908714124:jbock-annotations:4.3'
    annotationProcessor 'com.github.h908714124:jbock:4.3.001'
}

task jarWithDeps(dependsOn: 'jar', type: Copy) {
    def conf = configurations.compileClasspath
    from conf.allDependencies.collect { conf.files(it) }
    into "${project.buildDir}/libs"
}

tasks.build.dependsOn(jarWithDeps)
