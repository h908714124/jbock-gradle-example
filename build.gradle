plugins {
    id 'java'
}

java {
    toolchain {
        languageVersion = JavaLanguageVersion.of(11)
    }
}

compileJava {
    options.encoding = 'UTF-8'
    sourceCompatibility = '11'
    targetCompatibility = '11'
}

jar {
    manifest {
        attributes 'Main-Class': 'net.jbock.cp.CopyFile'
    }
}

repositories {
    mavenCentral()
}

dependencies {
    compileOnly 'com.github.h908714124:jbock-annotations:4.4'
    annotationProcessor 'com.github.h908714124:jbock:4.4.000'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.12.3'
    implementation 'com.fasterxml.jackson.core:jackson-core:2.12.3'
}

task jarWithDeps(dependsOn: 'jar', type: Copy) {
    def conf = configurations.compileClasspath
    from conf.allDependencies.collect { conf.files(it) }
    into "${project.buildDir}/libs"
}

tasks.build.dependsOn(jarWithDeps)
